set(CMAKE_TOOLCHAIN_FILE ../cmake/toolchain-arm-gcc.cmake)
include(../cmake/compiler_flags.cmake)

set(GLOBAL_DEFINES
    -DSTM32F401xx
)

set(INCLUDE_DIRS
    #external
    external/stm32
    external/FreeRTOS/include
    external/cmsis
    external/ssd1306
    # hw
    hw/core_init
    hw/gpio_f4
    hw/usart
    hw/adc
    hw/i2c_master
    # utils
    utils
    # code
    code/hm_10
    code/joystick_controller
    code/display
    # main section
    initialization
)

set(C_SRCS
    #external
    external/stm32/system_stm32f4xx.c
    external/FreeRTOS/croutine.c
    external/FreeRTOS/event_groups.c
    external/FreeRTOS/heap_4.c
    external/FreeRTOS/hooks.c
    external/FreeRTOS/list.c
    external/FreeRTOS/port.c
    external/FreeRTOS/queue.c
    external/FreeRTOS/tasks.c
    external/FreeRTOS/timers.c
    external/ssd1306/ssd1306.c
    # hw 
    hw/startup/hardfault.c
    hw/core_init/core_init.c
    hw/gpio_f4/gpio_f4.c
    hw/usart/usart.c
    hw/adc/adc.c
    hw/i2c_master/i2c_master.c
    # code
    code/hm_10/hm_10.c
    code/joystick_controller/joystick_controller.c
    code/display/display.c
    # main section
    initialization/initialization.c
    main.c
)

set(ASM_SRCS
    hw/startup/startup_stm32f401vctx.s
)

set(LINKED_LIBS

)

link_directories(

)

include_directories(${INCLUDE_DIRS})
add_definitions(${GLOBAL_DEFINES})

# generate elf file
add_arm_executable(${CMAKE_PROJECT_NAME} ${C_SRCS} ${ASM_SRCS})